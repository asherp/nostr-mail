version: '2.4'

services:
  notebook:
    image: nostr-mail
    ports:
      - "8888:8888"
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      TZ: ${TZ:-America/New_York}
      DASH_DEBUG: "${DASH_DEBUG}"
      NOSTR_PRIV_KEY: ${NOSTR_PRIV_KEY}
      NOSTR_CONTACTS: "${NOSTR_CONTACTS}"
      PRIV_KEY_ALICE: "${PRIV_KEY_ALICE}"
      EMAIL_ALICE: "${EMAIL_ALICE}"
      PRIV_KEY_BOB: "${PRIV_KEY_BOB}"
      EMAIL_BOB: "${EMAIL_BOB}"
    volumes:
      - type: bind
        source: .
        target: /nostrmail
    container_name: nostr-notebook
    command:
      - jupyter
      - notebook
      - .
      - --port=8888
      - --no-browser
      - --ip=0.0.0.0
      - --allow-root
    working_dir: /nostrmail
  email:
    image: nostr-mail
    ports:
      - "8050:8050"
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      TZ: ${TZ:-America/New_York}
      DASH_DEBUG: "${DASH_DEBUG}"
      NOSTR_CONTACTS: "${NOSTR_CONTACTS}"
    volumes:
      - type: bind
        source: .
        target: /nostrmail
    container_name: nostr-mail
    command:
      - python
      - -u
      - dashboard.py
    working_dir: /nostrmail/nostrmail

