{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"nostr-mail","text":"<p>A modern, cross-platform email encryption tool that bridges Nostr and email protocols, providing end-to-end encrypted email communication using secp256k1 key pairs and the Nostr social key registry.</p>"},{"location":"#overview","title":"Overview","text":"<p>Nostr-mail encrypts email content using a symmetric key derived from a combination of the sender's private key and the receiver's public key. Both sender and receiver derive a shared secret known only to them, which is used to protect their communications.</p> <p>This application can use any email server for delivery while leveraging Nostr's decentralized social key registry for key discovery and management.</p>"},{"location":"#why-nostr-mail","title":"Why nostr-mail?","text":"<p>Nostr-mail aims to improve privacy for the average person by bridging the gap between Nostr and email. The two protocols serve different purposes, but they also solve each other's problems. For example, PGP does exist for email but it has not seen mainstream adoption because it relies on an existing key registry.</p> Feature Nostr Email nostr-mail Social Key Registry \u2713 \u2717 \u2713 PGP \u2713 \u2713 \u2713 Long form content \u2717 \u2713 \u2713 Archival Storage \u2717 \u2713 \u2713 Ubiquitous \u2717 \u2713 \u2713"},{"location":"#features","title":"Features","text":""},{"location":"#email-functionality","title":"\ud83d\udce7 Email Functionality","text":"<ul> <li>SMTP Email Sending: Send emails through configured SMTP servers</li> <li>IMAP Email Fetching: Fetch and display emails from IMAP servers</li> <li>Email Composition: Rich email composition with subject, body, and recipient fields</li> <li>Draft Saving: Save email drafts locally for later completion</li> <li>Email Preview: View email list with sender, subject, and preview text</li> <li>Email Details: Full email viewing with formatted content</li> <li>Attachment Support: Encrypt and send file attachments using hybrid encryption</li> </ul>"},{"location":"#nostr-integration","title":"\ud83d\udd10 Nostr Integration","text":"<ul> <li>Key Management: Generate and manage Nostr keypairs (nsec/npriv format)</li> <li>Profile Management: Create and update Nostr profiles with metadata</li> <li>Direct Messages: Send and receive encrypted direct messages via Nostr</li> <li>Relay Management: Configure and manage Nostr relays with enable/disable controls</li> <li>Contact Discovery: Automatically load contacts from your Nostr follow list</li> <li>Profile Caching: Cache profile data and images for offline access</li> </ul>"},{"location":"#contact-management","title":"\ud83d\udc65 Contact Management","text":"<ul> <li>Contact List: View all your Nostr contacts in a clean, organized interface</li> <li>Profile Details: View complete contact profiles with all available metadata</li> <li>Contact Actions: Send emails, direct messages, or copy public keys</li> <li>Smart Caching: Contacts load instantly from cache with progressive image loading</li> <li>In-Place Updates: Refresh contacts without clearing the list</li> <li>Alphabetical Sorting: Contacts are consistently sorted by name</li> </ul>"},{"location":"#user-interface","title":"\ud83c\udfa8 User Interface","text":"<ul> <li>Modern Design: Clean, responsive interface with gradient accents</li> <li>Dark Mode: Toggle between light and dark themes</li> <li>Tabbed Interface: Organized sections for Compose, Inbox, Sent, Drafts, DMs, Contacts, Profile, and Settings</li> <li>Responsive Layout: Works on desktop and mobile devices</li> <li>Loading States: Visual feedback during data loading and operations</li> <li>Notifications: Success and error notifications for user actions</li> </ul>"},{"location":"#tech-stack","title":"Tech Stack","text":""},{"location":"#frontend","title":"Frontend","text":"<ul> <li>Vanilla JavaScript: No framework dependencies for maximum performance</li> <li>HTML5: Semantic markup with accessibility features</li> <li>CSS3: Modern styling with CSS Grid, Flexbox, and custom properties</li> <li>Font Awesome: Icon library for consistent UI elements</li> </ul>"},{"location":"#backend-tauri","title":"Backend (Tauri)","text":"<ul> <li>Rust: High-performance backend for email and Nostr operations</li> <li>Tauri: Cross-platform desktop app framework (Windows, macOS, Linux, Android)</li> <li>Nostr Libraries: Rust Nostr implementation with NIP-44 and NIP-04 support</li> <li>Email Libraries: SMTP and IMAP support for email functionality</li> <li>SQLite: Local database for caching contacts, messages, and settings</li> </ul>"},{"location":"#encryption","title":"Encryption","text":"<ul> <li>NIP-44: Default encryption standard (recommended)</li> <li>NIP-04: Legacy encryption support for backward compatibility</li> <li>Hybrid Encryption: AES-256 for large attachments, NIP-44 for keys</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Ready to get started? Check out the Installation Guide and Quick Start Guide.</p>"},{"location":"#documentation","title":"Documentation","text":""},{"location":"#user-guides","title":"User Guides","text":"<ul> <li>Installation - Set up nostr-mail on your system</li> <li>Quick Start - Get up and running quickly</li> <li>Compose Page - Create and send encrypted emails</li> <li>Inbox Page - View and manage received emails</li> <li>Sent Page - View sent email history</li> <li>Drafts Page - Manage email drafts</li> <li>Direct Messages - Send and receive Nostr DMs</li> <li>Contacts Page - Manage your Nostr contacts</li> <li>Profile Page - Manage your Nostr profile</li> <li>Settings Page - Configure all application settings</li> </ul>"},{"location":"#technical-documentation","title":"Technical Documentation","text":"<ul> <li>Architecture - Project structure and data flow</li> <li>Development - Building and development workflow</li> <li>NIP-44 Encryption - Encryption standard details</li> </ul>"},{"location":"#legacy-documentation","title":"Legacy Documentation","text":"<ul> <li>Legacy Docker Setup - Old Docker/Python setup documentation</li> </ul>"},{"location":"NIP/","title":"NIP","text":""},{"location":"NIP/#nip-","title":"NIP-??","text":"<p>This NIP defines the basic requirements that should be implemented by anyone wanting to support email alongside nostr.</p>"},{"location":"NIP/#motivation","title":"Motivation","text":"<p>Email integration enables several features for nostr users that relays alone cannot.</p>"},{"location":"NIP/#long-form-messaging","title":"Long form messaging","text":"<p>Nostr messages are intended to mimic the short form messaging of social media. It is largely up to the relay to determine the length of messages, but attachments and formatting are not supported (other NIPs that address this?). Email can extend nostr's capabilities by providing an out-of-band means of communicating larger messages with attachments, which are more suitable in personal or business contexts.</p>"},{"location":"NIP/#archival-storage","title":"Archival storage","text":"<p>Nostr relays are not required to store DMs permanently. With nostr-mail DMs are replicated (in encrypted form) as the subject of an associated email. Thus, email provides a free backup for any DMs sent or received in this manner, in addition to any longer form content or files intended for long term storage.</p>"},{"location":"NIP/#email-authenticationidentification","title":"Email authentication/identification","text":"<p>While the NIP-05 standard allows nostr profiles to be associated with a user who controls their own domain, this is not the case for the vast majority of users. nostr-mail provides a more accessible way to associate one's identity with a public key, by including their email in the profile. The nostr-mail client setup process should be similar to traditional desktop email clients: simply allow the email server to accept SMTP connections and provide email credentials to the nostr-mail client.</p>"},{"location":"NIP/#email-privacy","title":"Email privacy","text":"<p>While Email PGP has been available in various forms since 1991, despite decades of attempts to educate the public, it has not seen wide adoption. Since all Nostr users have key pairs by default, we can leapfrog the education problems associated with traditional PGP. NIP-04 provides a mechanism for encrypting DMs, and we apply the scheme to encrypt/decrypt email content while linking them to specific Nostr DMs. nostr-mail intends to keep up-to-date with the latest encryption standards for DMs. </p>"},{"location":"NIP/#key-rotation","title":"Key rotation","text":"<p>In the event that a user loses access to their private key, Email provides an out-of-band means of communicating a new one. A more formal key rotation mechanism that utilizes email is outside the scope of this NIP, but we hope to address it further in the future!</p>"},{"location":"NIP/#email-signaling","title":"Email signaling","text":"<p><code>final</code> <code>optional</code> <code>author:asherp</code> <code>author:asherp</code></p> <p>A special <code>email</code> field in the user's profile is all that is required to signal that the user accepts encrypted email.</p> <p>Here is example python code that accomplishes this, using python-nostr</p> <pre><code>from nostr.relay_manager import RelayManager\nfrom nostr.key import PrivateKey\nfrom nostr.filter import Filter, Filters\nfrom nostr.event import Event, EventKind\nimport time\n\ndef publish_profile(priv_key, profile_dict):\n    relay_manager = RelayManager()\n\n    for relay in relays:\n        relay_manager.add_relay(relay)\n    relay_manager.open_connections({\"cert_reqs\": ssl.CERT_NONE}) # NOTE: This disables ssl certificate verification\n    print('waiting 1.5 sec to open')\n    time.sleep(1.5)\n\n    event_profile = Event(priv_key.public_key.hex(),\n                          json.dumps(profile_dict),\n                          kind=EventKind.SET_METADATA)\n    priv_key.sign_event(event_profile)\n\n    # check signature\n    assert event_profile.verify()\n    relay_manager.publish_event(event_profile)\n    print('waiting 1 sec to send')\n    time.sleep(1) # allow the messages to send\n\n    relay_manager.close_connections()\n    return event_profile.signature\n\nalice_profile = dict(display_name='Alice',\n              name='alice',\n              picture='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTV-0rZbgnQcRbDqbk0hHPLHPyHpqLJ8xkriA&amp;usqp=CAU',\n              about='my name is Alice..',\n              email='alice@tld.com')\n</code></pre>"},{"location":"NIP/#dm-replication","title":"DM replication","text":"<p>When an email is sent from a nostr-mail client, two things must occur:</p> <ol> <li>a DM with the encrypted subject of the email should be broadcast to the user's nostr relays</li> <li>the body of the email must be encrypted with the same shared secret.</li> <li>an email with the encrypted subject and body (using the same shared secret) must be sent via the user's SMTP server</li> </ol> <p>It is crucial that the email subject matches the encrypted DM exactly. This allows the receiver to verify that the email came from the same author as the DM - specifically, the author whose private key signed the DM event. Second, it allows the receiver to find the encrypted message on their mail server using the subject. Specifically, the <code>iv</code> string used in the encryption will be unique to that message.</p>"},{"location":"Profiles/","title":"Profiles","text":""},{"location":"Profiles/#profiles","title":"Profiles","text":"<p>Nostr-mail profiles require the <code>email</code> keyword to be available.</p> <p>Profiles may be loaded with the function <code>load_user_profile</code>.</p> <p>To test this, we'll assume Alice's priv key is stored in an environment variable.</p> <pre><code>from nostrmail.callbacks import load_user_profile, get_nostr_pub_key\nimport os\n</code></pre> <pre><code>alice_pub_key_hex = get_nostr_pub_key(os.environ['PRIV_KEY_ALICE'])\nalice_pub_key_hex\n</code></pre> <pre><code>profile = load_user_profile(alice_pub_key_hex)\n</code></pre> <pre><code>profile\n</code></pre> <p>Run the following cell to autoreload modifications to any above imports.</p> <pre><code>%load_ext autoreload\n%autoreload 2\n</code></pre>"},{"location":"Techstack/","title":"Techstack","text":"<p>Let's walk through the building blocks of nostr-mail. In addition to explaining how our implementation works, this should serve to illustrate how a similar strategy could be used for other platforms.</p>"},{"location":"Techstack/#dependencies","title":"Dependencies","text":""},{"location":"Techstack/#nostr","title":"nostr","text":"<p>Nostr-mail builds on the <code>python-nostr==0.0.2</code>, which may be found here. </p>"},{"location":"Techstack/#secp256k1","title":"secp256k1","text":"<p>This library handles the PGP side of nostr-mail and is a dependency of <code>python-nostr</code>. It is maintained by rustyrussell and may be found here.</p>"},{"location":"Techstack/#workflow","title":"Workflow","text":""},{"location":"Techstack/#privpub-key-generation","title":"priv/pub key generation","text":"<p>If you don't already have a nostr private key, use this to generate one. </p> <pre><code>from nostr.key import PrivateKey\n\nprivate_key = PrivateKey()\npublic_key = private_key.public_key\nprint(f\"Private key: {private_key.bech32()}\")\nprint(f\"Public key: {public_key.bech32()}\")\n</code></pre> <p>Copy and paste the above private key into <code>.env</code> at the root of this repo.</p> <pre><code>NOSTR_PRIV_KEY=&lt;priv key here&gt;\n</code></pre> <p>When you run the <code>nostrmail</code> container, this key will be used as the default private key if the environment variable is set.</p> <pre><code>import os\n</code></pre> <pre><code>try:\n    priv_key = os.environ['NOSTR_PRIV_KEY']\nexcept KeyError:\n    raise KeyError('Please set environment variable NOSTR_PRIV_KEY')\n</code></pre>"},{"location":"Techstack/#connecting-to-proxies","title":"Connecting to proxies","text":"<p>The following code is borrowed from the <code>python-nostr==0.0.2</code> docs. No attempt has been made to optimize relay connections on our part. There are open issues on <code>python-nostr</code> that address this. </p> <pre><code>import json\nimport ssl\nimport time\nfrom nostr.relay_manager import RelayManager\n\nrelay_manager = RelayManager()\nrelay_manager.add_relay(\"wss://nostr-pub.wellorder.net\")\nrelay_manager.add_relay(\"wss://relay.damus.io\")\nrelay_manager.add_relay(\"wss://relay.oldcity-bitcoiners.info\")\nrelay_manager.open_connections({\"cert_reqs\": ssl.CERT_NONE}) # NOTE: This disables ssl certificate verification\ntime.sleep(1.25) # allow the connections to open\n\nwhile relay_manager.message_pool.has_notices():\n    notice_msg = relay_manager.message_pool.get_notice()\n    print(notice_msg.content)\n\nrelay_manager.close_connections()\n</code></pre>"},{"location":"Techstack/#text-events","title":"Text events","text":"<p>From NIP-01 there are three kinds of events</p> <ul> <li>0: set_metadata: the content is set to a stringified JSON object {name: , about: , picture: } describing the user who created the event. A relay may delete past set_metadata events once it gets a new one for the same pubkey. <li>1: text_note: the content is set to the plaintext content of a note (anything the user wants to say). Markdown links ( stuff) are not plaintext.</li> <li>2: recommend_server: the content is set to the URL (e.g., wss://somerelay.com) of a relay the event creator wants to recommend to its followers.</li> <pre><code>from nostrmail.utils import get_events\n</code></pre> <p>Let's view HelloJessica's nostr events.</p> <pre><code>node_hello = 'npub1k9tkawv6ga6ptz3jl30pjzh68hk5mgvl28al5zc6r0myy849wvaq38a70g'\nnode_hello_hex = 'b1576eb99a4774158a32fc5e190afa3ded4da19f51fbfa0b1a1bf6421ea5733a'\n</code></pre> <pre><code>text_hello = get_events(node_hello_hex, 'text')\ntext_hello\n</code></pre> <pre><code>meta_hello = get_events(node_hello_hex, 'meta')\nmeta_hello\n</code></pre>"},{"location":"Techstack/#shared-secret","title":"Shared secret","text":"<p>First we'll create two key pairs, one for the sender and one for the receiver</p> <pre><code>from nostr.key import PrivateKey\n\npriv_key1 = PrivateKey()\npub_key1 = priv_key1.public_key\nprint(f\"Private key: {priv_key1.bech32()}\")\nprint(f\"Public key: {pub_key1.bech32()}\")\n</code></pre> <pre><code>priv_key2 = PrivateKey()\npub_key2 = priv_key2.public_key\nprint(f\"Private key: {priv_key1.bech32()}\")\nprint(f\"Public key: {pub_key1.bech32()}\")\n</code></pre> <pre><code>assert priv_key1.compute_shared_secret(pub_key2.hex()) == priv_key2.compute_shared_secret(pub_key1.hex())\n\nprint('shared secret validated!')\n</code></pre>"},{"location":"Techstack/#encryption","title":"Encryption","text":"<p>nostr-python already uses AES 256 (?) encryption. More on the encryption scheme can be found here https://github.com/jeffthibault/python-nostr/blob/37cb66ba2d3968b2d75cc8ad71c3550415ca47fe/nostr/key.py#L69</p> <pre><code>from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\nimport secrets\niv = secrets.token_bytes(16)\ncipher = Cipher(algorithms.AES(self.compute_shared_secret(public_key_hex)), modes.CBC(iv))\n</code></pre> <pre><code>help(priv_key1.encrypt_message)\n</code></pre> <pre><code>help(priv_key2.decrypt_message)\n</code></pre> <pre><code>clear_message = 'hello there'\n\nencrypted_msg = priv_key1.encrypt_message(clear_message, pub_key2.hex())\nencrypted_msg\n</code></pre> <pre><code>assert priv_key2.decrypt_message(encrypted_msg, pub_key1.hex()) == clear_message\n</code></pre> <p>This approach uses the key pairs alone. There is no timing information included.</p>"},{"location":"Techstack/#mock-email-flow","title":"Mock email flow","text":"<pre><code>sender_priv = PrivateKey()\nsender_pub = sender_priv.public_key.hex()\n\nemail_msg = \"\"\"\n    Well, hello there!\n\n    This is a decrypted message!\n\"\"\"\n\nreceiver_priv = PrivateKey()\nreceiver_pub = receiver_priv.public_key.hex()\n\nsender_secret = sender_priv.compute_shared_secret(receiver_pub)\nsender_secret # will match receiver secret\n</code></pre> <p><code>python-nostr/key.py</code></p> <pre><code>def compute_shared_secret(self, public_key_hex: str) -&gt; bytes:\n        pk = secp256k1.PublicKey(bytes.fromhex(\"02\" + public_key_hex), True)\n        return pk.ecdh(self.raw_secret, hashfn=copy_x)\n</code></pre> <p>The shared secret is the result of applying Elliptic Curve Diffie-Hellman, so it should return a point on the elliptic curve (which is just another public key)</p> <pre><code>sender_secret # can turn into hex encoded str\n</code></pre> <pre><code>encrypted_email = encrypt(email_msg, sender_secret)\nencrypted_email\n</code></pre> <pre><code>receiver_secret = receiver_priv.compute_shared_secret(sender_pub)\n\n# this works because the receiver_secret matches the sender_secret (hence, shared secret)\ndecrypted_email = decrypt(encrypted_email, receiver_secret)\nprint(decrypted_email)\n</code></pre>"},{"location":"Techstack/#try-connecting-to-damus","title":"Try connecting to Damus","text":"<pre><code>import json \nimport ssl\nimport time\nfrom nostr.event import Event\nfrom nostr.relay_manager import RelayManager\nfrom nostr.message_type import ClientMessageType\nfrom nostr.key import PrivateKey\n\nrelay_manager = RelayManager()\nrelay_manager.add_relay(\"wss://nostr-pub.wellorder.net\")\nrelay_manager.add_relay(\"wss://relay.damus.io\")\nrelay_manager.open_connections({\"cert_reqs\": ssl.CERT_NONE}) # NOTE: This disables ssl certificate verification\ntime.sleep(1.25) # allow the connections to open\n</code></pre> <pre><code>event = Event(pub_key_hex, \"Hello there\")\n</code></pre> <pre><code>priv_key.sign_event(event)\n</code></pre> <pre><code>assert event.verify() # checks signature on event\n</code></pre> <pre><code>relay_manager.publish_event(event)\ntime.sleep(1) # allow the messages to send\n\nrelay_manager.close_connections()\n</code></pre>"},{"location":"Techstack/#fetch-event-for-your-pub-key","title":"fetch event for your pub key","text":"<pre><code>from nostrmail.utils import get_events\n</code></pre> <pre><code>get_events(pub_key_hex)\n</code></pre> <pre><code>from nostr.key import mine_vanity_key\n</code></pre>"},{"location":"Techstack/#address-book","title":"Address book","text":"<pre><code>from omegaconf import OmegaConf\nimport pandas as pd\nimport dash_bootstrap_components as dbc\n</code></pre> <pre><code>from nostrmail.utils import load_contacts\n</code></pre> <pre><code>load_contacts()\n</code></pre> <pre><code>def update_contacts_table(url):\n    contacts = load_contacts()\n    table = dbc.Table.from_dataframe(contacts, index=True)\n    return table.children\n</code></pre>"},{"location":"Techstack/#create-user-profile","title":"create user profile","text":"<pre><code>try:\n    priv_key_str = os.environ['NOSTR_PRIV_KEY']\nexcept KeyError:\n    raise KeyError('Please set environment variable NOSTR_PRIV_KEY')\n</code></pre> <pre><code>priv_key = PrivateKey.from_nsec(priv_key_str)\nassert priv_key.bech32() == priv_key_str\n</code></pre> <pre><code>from nostrmail.utils import get_events, load_current_user\nfrom nostr.key import PrivateKey\nimport os\n</code></pre> <pre><code>\n</code></pre>"},{"location":"Techstack/#generate-alice-profile","title":"Generate Alice profile","text":"<pre><code>import os\n</code></pre> <pre><code>from nostr.event import EventKind\nfrom nostr.key import PrivateKey\nfrom nostr.event import Event\nfrom nostr.relay_manager import RelayManager\nimport json\nimport ssl\n\nalice_priv_key_str = os.environ['PRIV_KEY_ALICE']\nalice_email = os.environ['EMAIL_ALICE']\nalice_priv_key = PrivateKey.from_nsec(alice_priv_key_str)\nassert alice_priv_key.bech32() == alice_priv_key_str\n</code></pre> <pre><code>import time\n</code></pre> <pre><code>from nostrmail.utils import relays, publish_profile\n</code></pre> <pre><code>alice_profile = dict(display_name='Alice',\n              name='alice',\n              picture='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTV-0rZbgnQcRbDqbk0hHPLHPyHpqLJ8xkriA&amp;usqp=CAU',\n              about='my name is Alice..',\n              email=alice_email)\n</code></pre> <pre><code>sig = publish_profile(alice_priv_key, alice_profile)\n</code></pre> <pre><code>sig\n</code></pre> <p>Verify that profile was published</p> <pre><code>from nostrmail.utils import get_events\n</code></pre> <pre><code>alice_profile_remote = get_events(alice_priv_key.public_key.hex(), 'meta')[0]\n</code></pre> <pre><code>assert alice_profile_remote['email'] == alice_email\n</code></pre> <pre><code>alice_profile_remote\n</code></pre>"},{"location":"Techstack/#publish-bobs-profile","title":"Publish Bob's profile","text":"<pre><code>bob_priv_key_str = os.environ['PRIV_KEY_BOB']\nbob_email = os.environ['EMAIL_BOB']\nbob_priv_key = PrivateKey.from_nsec(bob_priv_key_str)\nassert bob_priv_key.bech32() == bob_priv_key_str\n</code></pre> <pre><code>bob_priv_key.public_key.hex()\n</code></pre> <pre><code>bob_profile = dict(display_name='Bob',\n              name='bob',\n              picture='https://cdnb.artstation.com/p/assets/images/images/030/065/923/large/in-house-media-bobgundisplay.jpg?1599501909',\n              about=\"I am the one they call Bob\",\n              email=bob_email)\n</code></pre> <pre><code>sig = publish_profile(bob_priv_key, bob_profile)\n</code></pre> <pre><code>bob_profile_remote = get_events(bob_priv_key.public_key.hex(), 'meta')[0]\n</code></pre> <pre><code>assert bob_profile_remote['email'] == bob_email\n</code></pre> <pre><code>bob_profile_remote\n</code></pre> <pre><code>bob_priv_key.public_key.hex()\n</code></pre>"},{"location":"Techstack/#direct-message","title":"Direct Message","text":"<p>Test delivery of the email subject via dm. The standard is defined in https://github.com/nostr-protocol/nips/blob/master/04.md</p> <ul> <li>text is encrypted with <code>base64-encoded, aes-256-cbc</code> using the x-coordinate of the shared point between sender/receiver</li> <li>content includes an initialization vector <code>\"content\": \"&lt;encrypted_text&gt;?iv=&lt;initialization_vector&gt;\"</code></li> <li><code>tags</code> MUST contain an entry identifying the receiver of the message in the form <code>[\"p\", \"&lt;pubkey, as a hex string&gt;\"]</code>.</li> <li><code>tags</code> MAY contain an entry identifying the previous message in a conversation or a message we are explicitly replying to, in the form <code>[\"e\", \"&lt;event_id&gt;\"]</code>.</li> </ul> <pre><code>from nostr.key import PrivateKey\nimport os\nalice_priv_key_str = os.environ['PRIV_KEY_ALICE']\nalice_email = os.environ['EMAIL_ADDRESS_ALICE']\nalice_priv_key = PrivateKey.from_nsec(alice_priv_key_str)\nassert alice_priv_key.bech32() == alice_priv_key_str\n\nbob_priv_key_str = os.environ['PRIV_KEY_BOB']\nbob_email = os.environ['EMAIL_ADDRESS_BOB']\nbob_priv_key = PrivateKey.from_nsec(bob_priv_key_str)\nassert bob_priv_key.bech32() == bob_priv_key_str\n</code></pre> <p>Confirm that we can create a valid priv key from the one provided</p> <pre><code>from nostrmail.utils import relays, publish_direct_message\n</code></pre> <pre><code># publish_direct_message(alice_priv_key, bob_priv_key.public_key.hex(), \"hi ho bob!\")\n</code></pre> <pre><code>from nostrmail.utils import get_events\n</code></pre> <pre><code>txt_events = get_events(bob_priv_key.public_key.hex(), kind='dm', returns='event')\n</code></pre> <pre><code>for e in txt_events:\n    print(e.content, e.tags)\n</code></pre> <pre><code>bob_priv_key.public_key.hex()\n</code></pre> <pre><code>bob_priv_key.decrypt_message(e.content, alice_priv_key.public_key.hex())\n</code></pre> <pre><code># publish_direct_message(bob_priv_key, alice_priv_key.public_key.hex(), 'hullo, hullo!', e.id)\n</code></pre> <pre><code>from nostrmail.utils import get_dms, get_convs\n</code></pre> <pre><code>import pandas as pd\n</code></pre> <pre><code>alice_dms = get_dms(alice_priv_key.public_key.hex())\n</code></pre> <pre><code>alice_priv_key.public_key.hex()\n</code></pre> <pre><code>dms = pd.DataFrame(alice_dms)\ndms['conv'] = get_convs(dms)\n</code></pre> <pre><code>dms\n</code></pre> <pre><code>pd.DataFrame(alice_dms).set_index('time').sort_index(ascending=False)\n</code></pre> <pre><code>bob_dms = get_dms(bob_priv_key.public_key.hex())\n</code></pre> <pre><code>bob_dms_df = pd.DataFrame(bob_dms)\n</code></pre> <pre><code>bob_dms_df['convs'] = get_convs(bob_dms_df)\n</code></pre> <pre><code>bob_dms_df\n</code></pre> <pre><code>bob_dms\n</code></pre> <pre><code>def get_encryption_iv(msg):\n    \"\"\"extract the iv from an encrypted blob\"\"\"\n    return msg.split('?iv=')[-1].strip('==')\n</code></pre> <pre><code>for id_, _ in pd.DataFrame(bob_dms).iterrows():\n    print(get_encryption_iv(_.content), alice_priv_key.decrypt_message(_.content, bob_priv_key.public_key.hex()))\n</code></pre> <pre><code>alice_priv_key.decrypt_message(_.content, bob_priv_key.public_key.hex())\n</code></pre> <pre><code># from nostr.event import EncryptedDirectMessage # this isn't available as of nostr==0.0.2\n\n# dm = EncryptedDirectMessage(\n#   recipient_pubkey=recipient_pubkey,\n#   cleartext_content=\"Secret message!\"\n# )\n# private_key.sign_event(dm)\n# relay_manager.publish_event(dm)\n</code></pre>"},{"location":"Techstack/#contacts","title":"Contacts","text":"<p>There's a nip for contacts! https://github.com/nostr-protocol/nips/blob/master/02.md e.g. frank.david.erin </p>"},{"location":"Techstack/#search-email-by-subject","title":"search email by subject","text":"<pre><code>import imaplib\nimport email\n</code></pre> <pre><code>import os\n</code></pre> <pre><code>email_imap = os.environ['IMAP_HOST']\n</code></pre> <pre><code>email_username = os.environ['EMAIL_ADDRESS']\n</code></pre> <pre><code>email_password = os.environ['EMAIL_PASSWORD']\n</code></pre> <pre><code># Set up connection to IMAP server\nmail = imaplib.IMAP4_SSL(email_imap)\n</code></pre> <pre><code>if not email_is_logged_in(mail):\n    print('logging in')\n    mail.login(email_username, email_password)\n</code></pre> <pre><code>mail.login(email_username, email_password)\n</code></pre> <pre><code>email_is_logged_in(mail)\n</code></pre> <pre><code>if not email_is_logged_in(mail):\n    print('logging in')\n    mail.login(email_username, email_password)\n</code></pre> <pre><code>from dash import html\n</code></pre> <pre><code>mail.select('Inbox')\n</code></pre> <pre><code># email_body = find_email_by_subject(mail, 'bVpH/kND9hb1p83A0saXYw')\nemail_body = find_email_by_subject(mail, 'r2e7cDJR6dqDgShm6w')\n\nemail_body\n</code></pre> <pre><code>type(email_body)\n</code></pre> <pre><code>check_if_email_logged_in(mail)\n</code></pre> <pre><code>from dash import dcc\n</code></pre> <pre><code>dcc.Markdown?\n</code></pre> <pre><code>print(alice_priv_key.decrypt_message(email_body, bob_priv_key.public_key.hex()))\n</code></pre> <pre><code>imaplib.IMAP4_SSL?\n</code></pre> <pre><code># Close the mailbox and logout from the IMAP server\nmail.close()\nmail.logout()\n</code></pre> <pre><code>assert not email_is_logged_in(mail)\n</code></pre>"},{"location":"Techstack/#filters","title":"Filters","text":"<pre><code>from nostr.filter import Filter, Filters\n</code></pre> <pre><code>Filters?\n</code></pre> <pre><code>Filter?\n</code></pre> <pre><code>%load_ext autoreload\n%autoreload 2\n</code></pre>"},{"location":"Techstack/#block-height-caching","title":"Block height caching","text":"<p>We'll use block height to cache profile data.</p> <pre><code>from nostrmail.utils import get_block_hash, get_block_info, get_latest_block_hash\n</code></pre> <pre><code>block_hash = get_latest_block_hash()\n</code></pre> <pre><code>block_hash\n</code></pre> <pre><code>latest_block = get_block_info(block_hash=block_hash)\n</code></pre> <pre><code>latest_block['height']\n</code></pre> <pre><code>\n</code></pre>"},{"location":"WorkLog/","title":"WorkLog","text":"<p>This project uses hourly for labor accounting.</p> <ul> <li>when changing email addresses, app has trouble decrypting emails in db</li> <li>mac build instructions</li> <li> <p>building on a mac for android, you'll need:     java (from adoptium)     make, which you can get from xcode command line tools:         xcode-select --install     cmake (from cmake.org)     set the following env varibles      ANDROID_HOME=/path/to/user/Library/Android/sdk\\nexport ANDROID_SDK_ROOT=$ANDROID_HOME\\nexport ANDROID_NDK_HOME=$ANDROID_HOME/ndk/29.0.13846066\\nexport ANDROID_NDK_ROOT=$ANDROID_NDK_HOME\\nexport PATH=\"$ANDROID_HOME/platform-tools:$ANDROID_HOME/emulator:$ANDROID_HOME/cmdline-tools/latest/bin:$ANDROID_NDK_HOME/toolchains/llvm/prebuilt/darwin-x86_64/bin:$PATH\"</p> </li> <li> <p>encrypted attachments, manifest</p> </li> <li>NIP-44 may fail if email body is too long, so witch to mainfest style if/when that happens</li> <li>live updates</li> <li>persistent relay connections</li> <li>email body inline with DM</li> <li>checkbox for dm notification</li> <li>fixed double encryption bug in subject dm</li> <li>fix render dm avatar</li> <li>fix follow contact, jwt image rendering</li> <li>fetch inbox emails for current user</li> <li>switch between profiles</li> <li>fixed profile update button, jump to send dm</li> <li>sqlite db</li> <li>fetch nostr emails only, decrypt content</li> <li>refactor frontend</li> <li>send DM working</li> <li>fetch emails, filtering</li> <li>working email send</li> <li>dm decryption</li> <li>tauri app prototype</li> </ul>"},{"location":"WorkLog/#2023-10-30-201234177188-clock-out","title":"2023-10-30 20:12:34.177188: clock-out","text":"<ul> <li>nav, compose, inbox, settings layout</li> </ul>"},{"location":"WorkLog/#2023-10-30-180046852777-clock-in","title":"2023-10-30 18:00:46.852777: clock-in","text":""},{"location":"WorkLog/#2023-10-30-103301810709-clock-out","title":"2023-10-30 10:33:01.810709: clock-out","text":"<ul> <li>kivy app</li> </ul>"},{"location":"WorkLog/#2023-10-30-082941131573-clock-in","title":"2023-10-30 08:29:41.131573: clock-in","text":""},{"location":"WorkLog/#2023-04-29-011150217567-clock-out","title":"2023-04-29 01:11:50.217567: clock-out","text":"<ul> <li>documentation, presentation</li> </ul>"},{"location":"WorkLog/#2023-04-28-230624151223-clock-in","title":"2023-04-28 23:06:24.151223: clock-in","text":""},{"location":"WorkLog/#2023-04-28-180130320739-clock-out","title":"2023-04-28 18:01:30.320739: clock-out","text":"<ul> <li>packaging, discussion with Tadge</li> <li>Tadgh Drija on cc'ing: use a single encryption key and encrypt it to everyone's pub keys and include the whole decryption package in the message. This could be a json blob storing the following</li> </ul> <pre><code>scheme: aes256\nreceiver keys:\n- pub_key: encrypted decryption key\n- ...\n</code></pre>"},{"location":"WorkLog/#2023-04-28-175510766292-clock-in","title":"2023-04-28 17:55:10.766292: clock-in","text":""},{"location":"WorkLog/#2023-04-28-120540850929-clock-out","title":"2023-04-28 12:05:40.850929: clock-out","text":"<ul> <li>docs</li> </ul>"},{"location":"WorkLog/#2023-04-28-102811651768-clock-in","title":"2023-04-28 10:28:11.651768: clock-in","text":""},{"location":"WorkLog/#2023-04-23-150829738699-clock-out","title":"2023-04-23 15:08:29.738699: clock-out","text":"<ul> <li>handle imap connection error</li> </ul>"},{"location":"WorkLog/#2023-04-23-145312076305-clock-in","title":"2023-04-23 14:53:12.076305: clock-in","text":""},{"location":"WorkLog/#2023-04-23-101754445850-clock-out","title":"2023-04-23 10:17:54.445850: clock-out","text":"<ul> <li>caching improvements looking at session storage</li> </ul>"},{"location":"WorkLog/#2023-04-23-091940385017-clock-in","title":"2023-04-23 09:19:40.385017: clock-in","text":""},{"location":"WorkLog/#2023-04-19-234327964016-clock-out","title":"2023-04-19 23:43:27.964016: clock-out","text":"<ul> <li>improved loading times to avoid timeout</li> </ul>"},{"location":"WorkLog/#2023-04-19-230312254233-clock-in","title":"2023-04-19 23:03:12.254233: clock-in","text":""},{"location":"WorkLog/#2023-04-15-105738662251-clock-out","title":"2023-04-15 10:57:38.662251: clock-out","text":"<ul> <li>refreshing user profile</li> </ul>"},{"location":"WorkLog/#2023-04-15-095933579529-clock-in","title":"2023-04-15 09:59:33.579529: clock-in","text":""},{"location":"WorkLog/#2023-04-15-094901574530-clock-out","title":"2023-04-15 09:49:01.574530: clock-out","text":"<ul> <li>cache reset button</li> </ul>"},{"location":"WorkLog/#2023-04-15-091532803650-clock-in","title":"2023-04-15 09:15:32.803650: clock-in","text":""},{"location":"WorkLog/#2023-04-10-224809284772-clock-out","title":"2023-04-10 22:48:09.284772: clock-out","text":"<ul> <li>testing user container</li> </ul>"},{"location":"WorkLog/#2023-04-10-220543542150-clock-in","title":"2023-04-10 22:05:43.542150: clock-in","text":"<ul> <li>to sanize emails, check out amonia with nh3 python binding https://nh3.readthedocs.io/en/latest/</li> </ul>"},{"location":"WorkLog/#2023-04-09-235100895163-clock-out","title":"2023-04-09 23:51:00.895163: clock-out","text":"<ul> <li>update profile button</li> </ul>"},{"location":"WorkLog/#2023-04-09-220851287745-clock-in","title":"2023-04-09 22:08:51.287745: clock-in","text":""},{"location":"WorkLog/#2023-04-09-102557371034-clock-out","title":"2023-04-09 10:25:57.371034: clock-out","text":"<ul> <li>hot reload by env, edit user profile</li> </ul>"},{"location":"WorkLog/#2023-04-09-101108859105-clock-in","title":"2023-04-09 10:11:08.859105: clock-in","text":""},{"location":"WorkLog/#2023-04-08-191840274196-clock-out","title":"2023-04-08 19:18:40.274196: clock-out","text":"<ul> <li>documentation</li> </ul>"},{"location":"WorkLog/#2023-04-08-181251398424-clock-in","title":"2023-04-08 18:12:51.398424: clock-in","text":"<ul> <li>example env file</li> </ul>"},{"location":"WorkLog/#2023-04-08-134435437850-clock-out","title":"2023-04-08 13:44:35.437850: clock-out","text":"<ul> <li>got email working with dms</li> </ul>"},{"location":"WorkLog/#2023-04-08-104550749441-clock-in","title":"2023-04-08 10:45:50.749441: clock-in","text":""},{"location":"WorkLog/#2023-03-26-161400530769-clock-out","title":"2023-03-26 16:14:00.530769: clock-out","text":"<ul> <li>rendering avatars in inbox</li> </ul>"},{"location":"WorkLog/#2023-03-26-151745151187-clock-in","title":"2023-03-26 15:17:45.151187: clock-in","text":""},{"location":"WorkLog/#2023-03-21-141928772712-clock-out","title":"2023-03-21 14:19:28.772712: clock-out","text":"<ul> <li>conversations</li> </ul>"},{"location":"WorkLog/#2023-03-21-130606735484-clock-in","title":"2023-03-21 13:06:06.735484: clock-in","text":""},{"location":"WorkLog/#2023-03-20-190945883040-clock-out-t-10m","title":"2023-03-20 19:09:45.883040: clock-out: T-10m","text":"<ul> <li>update inbox, avatars</li> </ul>"},{"location":"WorkLog/#2023-03-20-181156948100-clock-in","title":"2023-03-20 18:11:56.948100: clock-in","text":""},{"location":"WorkLog/#2023-03-20-110501507585-clock-out","title":"2023-03-20 11:05:01.507585: clock-out","text":"<ul> <li>fetching dms</li> </ul>"},{"location":"WorkLog/#2023-03-20-101438822856-clock-in","title":"2023-03-20 10:14:38.822856: clock-in","text":""},{"location":"WorkLog/#2023-03-19-234545312979-clock-out","title":"2023-03-19 23:45:45.312979: clock-out","text":""},{"location":"WorkLog/#2023-03-19-223839007652-clock-in","title":"2023-03-19 22:38:39.007652: clock-in","text":""},{"location":"WorkLog/#2023-03-19-213820532966-clock-out","title":"2023-03-19 21:38:20.532966: clock-out","text":"<ul> <li>setting up dms</li> </ul>"},{"location":"WorkLog/#2023-03-19-211030939365-clock-in","title":"2023-03-19 21:10:30.939365: clock-in","text":""},{"location":"WorkLog/#2023-03-19-020402230490-clock-out","title":"2023-03-19 02:04:02.230490: clock-out","text":"<ul> <li>email send</li> </ul>"},{"location":"WorkLog/#2023-03-18-233936131727-clock-in","title":"2023-03-18 23:39:36.131727: clock-in","text":"<ul> <li>ignoring env</li> </ul>"},{"location":"WorkLog/#2023-03-18-220731239372-clock-out","title":"2023-03-18 22:07:31.239372: clock-out","text":"<ul> <li>encrypting subject and body to receiver</li> </ul>"},{"location":"WorkLog/#2023-03-18-202313413597-clock-in","title":"2023-03-18 20:23:13.413597: clock-in","text":""},{"location":"WorkLog/#2023-03-18-185629590170-clock-out","title":"2023-03-18 18:56:29.590170: clock-out","text":"<ul> <li>render user profile, credentials</li> </ul>"},{"location":"WorkLog/#2023-03-18-174322541161-clock-in","title":"2023-03-18 17:43:22.541161: clock-in","text":""},{"location":"WorkLog/#2023-03-17-222616589981-clock-out-t-30m","title":"2023-03-17 22:26:16.589981: clock-out: T-30m","text":"<ul> <li>alice, bob services</li> </ul>"},{"location":"WorkLog/#2023-03-17-210816620064-clock-in","title":"2023-03-17 21:08:16.620064: clock-in","text":""},{"location":"WorkLog/#2023-03-12-221603525915-clock-out","title":"2023-03-12 22:16:03.525915: clock-out","text":"<ul> <li>fetching email, profile pics</li> </ul>"},{"location":"WorkLog/#2023-03-12-212832683363-clock-in","title":"2023-03-12 21:28:32.683363: clock-in","text":""},{"location":"WorkLog/#2023-03-12-190752308489-clock-out","title":"2023-03-12 19:07:52.308489: clock-out","text":"<ul> <li>imap receiver</li> </ul>"},{"location":"WorkLog/#2023-03-12-185217463282-clock-in","title":"2023-03-12 18:52:17.463282: clock-in","text":""},{"location":"WorkLog/#2023-03-11-223758222838-clock-out","title":"2023-03-11 22:37:58.222838: clock-out","text":"<ul> <li>publish alice and bob profiles</li> </ul>"},{"location":"WorkLog/#2023-03-11-220811340599-clock-in","title":"2023-03-11 22:08:11.340599: clock-in","text":""},{"location":"WorkLog/#2023-03-11-204025042590-clock-out","title":"2023-03-11 20:40:25.042590: clock-out","text":"<ul> <li>alice and bob keys</li> </ul>"},{"location":"WorkLog/#2023-03-11-194755859711-clock-in","title":"2023-03-11 19:47:55.859711: clock-in","text":""},{"location":"WorkLog/#2023-03-11-175930794963-clock-out","title":"2023-03-11 17:59:30.794963: clock-out","text":"<ul> <li>rendering contacts profile</li> </ul>"},{"location":"WorkLog/#2023-03-11-153757782640-clock-in","title":"2023-03-11 15:37:57.782640: clock-in","text":""},{"location":"WorkLog/#2023-03-11-144505108228-clock-out","title":"2023-03-11 14:45:05.108228: clock-out","text":"<ul> <li>switch from Fernet to nostr encryption scheme</li> </ul>"},{"location":"WorkLog/#2023-03-11-132819085627-clock-in","title":"2023-03-11 13:28:19.085627: clock-in","text":""},{"location":"WorkLog/#2023-03-05-200743617401-clock-out","title":"2023-03-05 20:07:43.617401: clock-out","text":"<ul> <li>setting up container priv keys</li> </ul>"},{"location":"WorkLog/#2023-03-05-191313083170-clock-in","title":"2023-03-05 19:13:13.083170: clock-in","text":""},{"location":"WorkLog/#2023-03-01-205356066092-clock-out","title":"2023-03-01 20:53:56.066092: clock-out","text":"<ul> <li>adding credentials, settings</li> <li>sidebar example https://dash-bootstrap-components.opensource.faculty.ai/examples/simple-sidebar/</li> <li>configuring smtp https://red-mail.readthedocs.io/en/stable/tutorials/client.html#config-smtp</li> </ul>"},{"location":"WorkLog/#2023-03-01-191217414119-clock-in","title":"2023-03-01 19:12:17.414119: clock-in","text":""},{"location":"WorkLog/#2023-02-27-183014616845-clock-out","title":"2023-02-27 18:30:14.616845: clock-out","text":"<ul> <li>reading email in python https://www.thepythoncode.com/article/reading-emails-in-python</li> </ul>"},{"location":"WorkLog/#2023-02-27-182434923804-clock-in","title":"2023-02-27 18:24:34.923804: clock-in","text":""},{"location":"WorkLog/#2023-02-26-215620776792-clock-out","title":"2023-02-26 21:56:20.776792: clock-out","text":"<ul> <li>installable package, basic email gui</li> </ul>"},{"location":"WorkLog/#2023-02-26-204138192299-clock-in","title":"2023-02-26 20:41:38.192299: clock-in","text":""},{"location":"WorkLog/#2023-02-25-132956840093-clock-out","title":"2023-02-25 13:29:56.840093: clock-out","text":"<ul> <li>working symmetric TOTP encryption</li> </ul>"},{"location":"WorkLog/#2023-02-25-115502107526-clock-in","title":"2023-02-25 11:55:02.107526: clock-in","text":""},{"location":"WorkLog/#2023-02-25-113127280425-clock-out","title":"2023-02-25 11:31:27.280425: clock-out","text":"<ul> <li>nip05 p2p registry</li> </ul>"},{"location":"WorkLog/#2023-02-25-105424729659-clock-in","title":"2023-02-25 10:54:24.729659: clock-in","text":""},{"location":"WorkLog/#2023-02-16-162837548094-clock-out","title":"2023-02-16 16:28:37.548094: clock-out","text":"<ul> <li>set up dependencies, trying nostr queries</li> </ul>"},{"location":"WorkLog/#2023-02-16-143504909245-clock-in","title":"2023-02-16 14:35:04.909245: clock-in","text":""},{"location":"architecture/","title":"Architecture","text":""},{"location":"architecture/#project-structure","title":"Project Structure","text":"<pre><code>tauri-app/\n\u251c\u2500\u2500 frontend/              # Frontend assets\n\u2502   \u251c\u2500\u2500 index.html        # Main HTML file\n\u2502   \u251c\u2500\u2500 js/               # JavaScript modules\n\u2502   \u2502   \u251c\u2500\u2500 app.js        # Main application logic\n\u2502   \u2502   \u251c\u2500\u2500 app-state.js  # State management\n\u2502   \u2502   \u251c\u2500\u2500 email-service.js    # Email functionality\n\u2502   \u2502   \u251c\u2500\u2500 dm-service.js       # Direct messages\n\u2502   \u2502   \u251c\u2500\u2500 contacts-service.js # Contact management\n\u2502   \u2502   \u251c\u2500\u2500 tauri-service.js    # Backend communication\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 styles/          # CSS files\n\u2502       \u251c\u2500\u2500 variables.css\n\u2502       \u251c\u2500\u2500 email.css\n\u2502       \u251c\u2500\u2500 contacts.css\n\u2502       \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 backend/              # Rust backend\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u2502   \u251c\u2500\u2500 main.rs       # Main entry point\n\u2502   \u2502   \u251c\u2500\u2500 lib.rs        # Library exports\n\u2502   \u2502   \u251c\u2500\u2500 email.rs      # Email operations\n\u2502   \u2502   \u251c\u2500\u2500 nostr.rs      # Nostr protocol\n\u2502   \u2502   \u251c\u2500\u2500 crypto.rs     # Encryption/decryption\n\u2502   \u2502   \u251c\u2500\u2500 database.rs   # Database operations\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 Cargo.toml       # Rust dependencies\n\u2514\u2500\u2500 tauri.conf.json       # Tauri configuration\n</code></pre>"},{"location":"architecture/#data-flow","title":"Data Flow","text":"<p>1. Frontend (JavaScript) handles UI and user interactions</p> <p>2. Tauri Service bridges frontend and backend via Tauri commands</p> <p>3. Backend (Rust) handles:</p> <ul> <li>Email operations (SMTP/IMAP)</li> <li>Nostr operations (DMs, profiles, relays)</li> <li>Encryption/decryption (NIP-44/NIP-04)</li> <li>Database operations (SQLite)</li> </ul> <p>4. Database stores:</p> <ul> <li>Contacts and profiles</li> <li>Email messages</li> <li>DM conversations</li> <li>Settings and preferences</li> </ul>"},{"location":"architecture/#key-technologies","title":"Key Technologies","text":"<ul> <li>Tauri: Cross-platform framework wrapping Rust backend with web frontend</li> <li>nostr-sdk: Rust library for Nostr protocol implementation</li> <li>lettre: Rust email library for SMTP/IMAP</li> <li>rusqlite: SQLite database for local storage</li> <li>NIP-44: Modern encryption standard for Nostr messages</li> </ul>"},{"location":"architecture/#frontend-architecture","title":"Frontend Architecture","text":""},{"location":"architecture/#module-structure","title":"Module Structure","text":"<ul> <li>app-state.js: Centralized state management</li> <li>dom-manager.js: DOM element management utilities</li> <li>tauri-service.js: Backend communication layer</li> <li>email-service.js: Email-specific functionality</li> <li>dm-service.js: Direct message functionality</li> <li>contacts-service.js: Contact management</li> <li>notification-service.js: User feedback system</li> <li>utils.js: Common utility functions</li> </ul>"},{"location":"architecture/#state-management","title":"State Management","text":"<p>The application uses a centralized state management system (<code>appState</code>) that tracks:</p> <ul> <li>Contacts</li> <li>Direct messages</li> <li>Email messages</li> <li>Settings</li> <li>Keypair</li> <li>Relays</li> <li>Selection state</li> </ul>"},{"location":"architecture/#backend-architecture","title":"Backend Architecture","text":""},{"location":"architecture/#core-modules","title":"Core Modules","text":"<ul> <li>main.rs: Application entry point and Tauri command definitions</li> <li>lib.rs: Library exports and shared utilities</li> <li>email.rs: SMTP sending and IMAP fetching</li> <li>nostr.rs: Nostr protocol operations (DMs, profiles, relays)</li> <li>crypto.rs: Encryption/decryption operations</li> <li>database.rs: SQLite database operations</li> <li>types.rs: Shared type definitions</li> </ul>"},{"location":"architecture/#database-schema","title":"Database Schema","text":"<p>The SQLite database stores:</p> <ul> <li>Contacts (profiles, metadata)</li> <li>Email messages (encrypted content, metadata)</li> <li>DM conversations (encrypted messages, metadata)</li> <li>Settings (per-pubkey configuration)</li> <li>Relay configurations</li> </ul>"},{"location":"architecture/#security-considerations","title":"Security Considerations","text":"<ul> <li>The current private is stored in frontend localStorage (not in database)</li> <li>Entering a new private key effectively logs out of the previous profile</li> <li>Encryption happens in Rust backend</li> <li>Database is local and encrypted at rest (OS-level)</li> <li>All network communications use TLS/SSL</li> <li>NIP-44 encryption provides modern security guarantees</li> <li>App passwords are encrypted at rest via the user's private key</li> </ul> <p>The workflow for switching accounts is being simplified. Currently, the app will not keep store a previous private key when switching accounts, but the user data (private contacts, settings) will be stored with the public key.</p>"},{"location":"development/","title":"Development","text":""},{"location":"development/#development-workflow","title":"Development Workflow","text":"<ol> <li>Make Changes: Edit frontend (HTML/CSS/JS) or backend (Rust) code</li> <li>Hot Reload: Frontend changes reload automatically in dev mode</li> <li>Rebuild Backend: Rust changes require rebuilding (<code>cargo tauri dev</code> handles this)</li> <li>Test: Use browser mode for faster iteration, Tauri mode for full testing</li> </ol>"},{"location":"development/#running-in-development-mode","title":"Running in Development Mode","text":"<pre><code>cd tauri-app\ncargo tauri dev\n</code></pre> <p>This will: - Build the Rust backend - Start the Tauri application - Enable hot reload for frontend changes - Show console output for debugging</p>"},{"location":"development/#running-frontend-in-browser-development-mode","title":"Running Frontend in Browser (Development Mode)","text":"<p>You can run the frontend as a static site in your browser while connecting to the backend via HTTP:</p> <pre><code># On macOS/Linux:\n./run-browser-dev.sh\n\n# On Windows:\nrun-browser-dev.bat\n\n# Or manually:\n# Terminal 1: Start HTTP server\ncd backend\ncargo run --bin http-server --release\n\n# Terminal 2: Serve frontend\ncd frontend\npython3 -m http.server 8080\n# Then open http://127.0.0.1:8080 in your browser\n</code></pre> <p>The HTTP server runs on <code>http://127.0.0.1:1420</code> and the frontend is served on <code>http://127.0.0.1:8080</code>. The frontend automatically detects browser mode and uses HTTP instead of Tauri APIs.</p>"},{"location":"development/#building-for-production","title":"Building for Production","text":"<pre><code>cd tauri-app\ncargo tauri build\n</code></pre> <p>The built application will be in <code>backend/src-tauri/target/release/</code></p>"},{"location":"development/#build-targets","title":"Build Targets","text":"<ul> <li>Windows: <code>.exe</code> installer</li> <li>macOS: <code>.app</code> bundle and <code>.dmg</code> installer</li> <li>Linux: <code>.deb</code> and <code>.AppImage</code> packages</li> <li>Android: <code>.apk</code> file</li> </ul>"},{"location":"development/#code-organization","title":"Code Organization","text":""},{"location":"development/#frontend","title":"Frontend","text":"<ul> <li>Modular Architecture: Each major feature has its own service module</li> <li>State Management: Centralized state in <code>app-state.js</code></li> <li>DOM Management: Centralized DOM utilities in <code>dom-manager.js</code></li> <li>Service Layer: Backend communication abstracted in <code>tauri-service.js</code></li> </ul>"},{"location":"development/#backend","title":"Backend","text":"<ul> <li>Command Handlers: Tauri commands defined in <code>main.rs</code></li> <li>Business Logic: Feature-specific logic in separate modules (<code>email.rs</code>, <code>nostr.rs</code>, etc.)</li> <li>Database Layer: SQLite operations in <code>database.rs</code></li> <li>Type Safety: Shared types in <code>types.rs</code></li> </ul>"},{"location":"development/#debugging","title":"Debugging","text":""},{"location":"development/#frontend-debugging","title":"Frontend Debugging","text":"<ul> <li>Use browser DevTools when running in browser mode</li> <li>Console logs are available in Tauri dev mode</li> <li>Check <code>tauri-service.js</code> for backend communication issues</li> </ul>"},{"location":"development/#backend-debugging","title":"Backend Debugging","text":"<ul> <li>Rust compiler errors show in terminal</li> <li>Use <code>println!</code> macros for debugging (visible in terminal)</li> <li>Check Tauri console output for command execution</li> </ul>"},{"location":"development/#database-debugging","title":"Database Debugging","text":"<ul> <li>Database file location: OS-specific app data directory</li> <li>Use SQLite browser tools to inspect database</li> <li>Database schema defined in <code>database.rs</code></li> </ul>"},{"location":"development/#testing","title":"Testing","text":""},{"location":"development/#manual-testing","title":"Manual Testing","text":"<ul> <li>Test each page functionality</li> <li>Test email sending/receiving</li> <li>Test DM sending/receiving</li> <li>Test contact loading</li> <li>Test settings persistence</li> </ul>"},{"location":"development/#integration-testing","title":"Integration Testing","text":"<ul> <li>Test email + Nostr integration</li> <li>Test encryption/decryption</li> <li>Test database operations</li> <li>Test relay connectivity</li> </ul>"},{"location":"development/#contributing","title":"Contributing","text":"<ol> <li>Fork the repository</li> <li>Create a feature branch</li> <li>Make your changes</li> <li>Test thoroughly</li> <li>Submit a pull request</li> </ol>"},{"location":"development/#code-style","title":"Code Style","text":""},{"location":"development/#javascript","title":"JavaScript","text":"<ul> <li>Use ES6+ features</li> <li>Follow module pattern (services, utilities)</li> <li>Use meaningful variable names</li> <li>Add comments for complex logic</li> </ul>"},{"location":"development/#rust","title":"Rust","text":"<ul> <li>Follow Rust naming conventions</li> <li>Use <code>Result</code> types for error handling</li> <li>Add documentation comments</li> <li>Keep functions focused and small</li> </ul>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Rust (latest stable version)</li> <li>Cargo (comes with Rust)</li> <li>Tauri CLI (install with <code>cargo install tauri-cli</code>)</li> <li>System Dependencies:</li> <li>macOS: Xcode Command Line Tools</li> <li>Linux: <code>libwebkit2gtk-4.0-dev</code>, <code>build-essential</code>, <code>curl</code>, <code>wget</code>, <code>libssl-dev</code>, <code>libgtk-3-dev</code>, <code>libayatana-appindicator3-dev</code>, <code>librsvg2-dev</code></li> <li>Windows: Microsoft Visual Studio C++ Build Tools</li> </ul>"},{"location":"installation/#installation-steps","title":"Installation Steps","text":"<ol> <li>Clone the repository:</li> </ol> <pre><code>git clone https://github.com/asherp/nostr-mail\ncd nostr-mail/tauri-app\n</code></pre> <ol> <li>Install Tauri CLI (if not already installed):</li> </ol> <pre><code>cargo install tauri-cli\n</code></pre> <ol> <li>Start development server:</li> </ol> <pre><code>cargo tauri dev\n</code></pre>"},{"location":"installation/#building-for-production","title":"Building for Production","text":"<pre><code>cd tauri-app\ncargo tauri build\n</code></pre> <p>The built application will be in <code>backend/src-tauri/target/release/</code></p>"},{"location":"installation/#running-frontend-in-browser-development-mode","title":"Running Frontend in Browser (Development Mode)","text":"<p>You can run the frontend as a static site in your browser while connecting to the backend via HTTP:</p> <pre><code># On macOS/Linux:\n./run-browser-dev.sh\n\n# On Windows:\nrun-browser-dev.bat\n\n# Or manually:\n# Terminal 1: Start HTTP server\ncd backend\ncargo run --bin http-server --release\n\n# Terminal 2: Serve frontend\ncd frontend\npython3 -m http.server 8080\n# Then open http://127.0.0.1:8080 in your browser\n</code></pre> <p>The HTTP server runs on <code>http://127.0.0.1:1420</code> and the frontend is served on <code>http://127.0.0.1:8080</code>. The frontend automatically detects browser mode and uses HTTP instead of Tauri APIs.</p>"},{"location":"legacy/","title":"Legacy Docker Setup","text":"<p>Note: This documentation is for the legacy Docker/Python setup. For the current cross-platform Tauri application, see the main documentation.</p>"},{"location":"legacy/#overview","title":"Overview","text":"<p>A simple email encryption tool based on secp256k1 key pairs.</p> <p>How it works:</p> <p>Nostr-mail encrypts content using a symmetric key derived from a combination of the sender's private key and the receiver's public key.</p> <p>Both sender and receiver derive a shared secret known only to them, which is used to protect their communications.</p> <p>This application can use any email server for delivery.</p>"},{"location":"legacy/#why-have-you-done-this","title":"Why have you done this?","text":"<p>Nostr-mail aims to improve privacy for the average person by bridging the gap between nostr and email. The two protocols serve different purposes, but they also solve each other's problems. For example, PGP does exist for email but it has not seen mainstream adoption because it relies on an existing key registry.</p> Feature Nostr Email nostr-mail Social Key Registry PGP Long form content Archival Storage Ubiquitous"},{"location":"legacy/#obligatory-warning","title":"Obligatory warning","text":"<p>Nostr-mail uses NIP-04, which has many issues pointed out here. While not perfect, it's better than cleartext emails. </p>"},{"location":"legacy/#usage","title":"Usage","text":"<p>You'll need Docker.</p> <p>Clone and navigate to the base of the repo directory, then:</p> <pre><code>docker compose up nostrmail\n</code></pre> <p>Navigate to http://localhost:8050</p> <p>Here are all the services you can run with <code>docker compose up &lt;service name&gt;</code></p> service purpose port nostrmail main dashboard site 8050 alice \"Alice\" dashboard for testing 8051 bob \"Bob\" dashboard for testing 8052 docs documentation site 8000 notebook jupyter notebook for prototyping 8888"},{"location":"legacy/#configuration","title":"Configuration","text":""},{"location":"legacy/#environment-variables","title":"Environment variables","text":"<p>Create a <code>.env</code> file and place it in the base of this repo to set the defaults for the above containers.</p> <pre><code># This file is used for the docker app. It is not needed to run the tauri app.\n\nNOSTR_PRIV_KEY=&lt;your priv key&gt;\nEMAIL_ADDRESS=&lt;your public email address&gt;\nEMAIL_PASSWORD=&lt;email password&gt;\n\n# email server, assuming gmail\nIMAP_HOST=imap.gmail.com\nIMAP_PORT=2525\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\n\n# this is where we find pub keys for now (should use NIP-02)\nNOSTR_CONTACTS=/nostrmail/address_book.yaml\n\n# the below configuration is for test purposes only\nPRIV_KEY_ALICE=&lt;priv key for alice&gt;\nEMAIL_ADDRESS_ALICE=yourname+alice@gmail.com\nEMAIL_PASSWORD_ALICE=&lt;same email password as above&gt;\n\nPRIV_KEY_BOB=&lt;priv key for bob&gt;\nEMAIL_ADDRESS_BOB=yourname+bob@gmail.com\nEMAIL_PASSWORD_BOB=&lt;same password as above&gt;\n\nNOSTR_MAIL_IMAGE_TAG=&lt;dockerhub_username&gt;/nostr-mail\n\n\n# HOST_DISPLAY is used to allow the containerized app to be rendered on the host machine\n\n# for mac:\nHOST_DISPLAY=host.docker.internal:0\n\n# for linux:\nHOST_DISPLAY=:0\n</code></pre>"},{"location":"legacy/#address-bookrelays","title":"Address book/relays","text":"<p>Create a file in the local directory called <code>address_book.yaml</code> to specify private contacts. Here's an example:</p> <pre><code>contacts:\n  - username: alice\n    pubkey: 12697aa72d2269aa632319d000b0548235d1d385dc16260ca77f704e802b5483\n  - username: bob\n    pubkey: 8619149c5549fa9970c042da77d9d018c7213e83aa49b89c234da9c298ecb941\n  - username: asher\n    pubkey: 86fb0bd1f7edcb17b39e897488f51f1d22ac6bd93aae491fc7cd45c9fb0d4ad8\nrelays:\n  - wss://nostr-pub.wellorder.net\n  - wss://relay.damus.io\n</code></pre>"},{"location":"legacy/#email","title":"Email","text":"<p>Configure your email account to allow sending and receiving emails. Here are instructions for Gmail:</p> <ol> <li>Generate an app password (required if using 2-factor auth). See https://support.google.com/accounts/answer/185833?hl=en </li> </ol> <p>Note: The password should be 16 characters in 4 sets of 4 but if you copy/paste it there will be spaces between each set of characters that you'll need to remove.</p> <ol> <li>Set <code>EMAIL_PASSWORD</code> in your <code>.env</code> file as explained above.</li> <li>Open Gmail settings to enable IMAP:<ol> <li>In the top right, click Settings and then See all settings.</li> <li>Click the Forwarding and POP/IMAP tab.</li> <li>In the \"IMAP access\" section, select Enable IMAP.</li> <li>Click Save Changes.</li> </ol> </li> </ol>"},{"location":"nip44/","title":"NIP-44 Encryption","text":"<p>Nostr-mail uses NIP-44 as the default encryption standard for all encrypted communications.</p>"},{"location":"nip44/#what-is-nip-44","title":"What is NIP-44?","text":"<p>NIP-44 is a modern encryption standard for Nostr that provides: - Better Security: Improved cryptographic properties compared to NIP-04 - Versioning: Supports multiple encryption versions for future improvements - Standardization: Widely adopted across Nostr clients</p>"},{"location":"nip44/#nip-44-vs-nip-04","title":"NIP-44 vs NIP-04","text":"Feature NIP-44 NIP-04 Security Modern, secure Legacy, known issues Versioning Supported Not supported Adoption Growing Legacy Recommendation \u2713 Use \u2717 Avoid"},{"location":"nip44/#encryption-details","title":"Encryption Details","text":"<ul> <li>Algorithm: NIP-44 encryption using shared secret derived from keypairs</li> <li>Default: NIP-44 is the default for all new installations</li> <li>Backward Compatibility: NIP-04 is supported for reading legacy messages</li> <li>Attachments: Hybrid encryption (AES-256 for files, NIP-44 for keys)</li> </ul>"},{"location":"nip44/#how-it-works","title":"How It Works","text":"<ol> <li>Shared Secret: Derived from sender's private key and receiver's public key using ECDH</li> <li>Encryption: Message encrypted using NIP-44 standard</li> <li>Decryption: Receiver uses their private key and sender's public key to derive the same shared secret</li> <li>Versioning: NIP-44 supports version numbers for future algorithm improvements</li> </ol>"},{"location":"nip44/#security-notes","title":"Security Notes","text":"<ul> <li>NIP-44 provides better security than NIP-04</li> <li>All new messages use NIP-44 by default</li> <li>Legacy NIP-04 messages can still be decrypted</li> <li>Consider migrating old conversations to NIP-44</li> <li>Private keys never leave the local device</li> <li>Encryption happens in the Rust backend</li> </ul>"},{"location":"nip44/#configuration","title":"Configuration","text":"<p>You can select the encryption algorithm in Settings \u2192 Nostr Settings \u2192 Encryption Algorithm: - NIP-44 (Recommended): Modern, secure encryption standard - NIP-04 (Legacy): Older encryption standard with known issues</p>"},{"location":"nip44/#migration-from-nip-04","title":"Migration from NIP-04","text":"<p>If you have existing NIP-04 encrypted messages: 1. They will continue to work (backward compatibility) 2. New messages will use NIP-44 by default 3. Consider re-encrypting important conversations with NIP-44</p>"},{"location":"nip44/#technical-details","title":"Technical Details","text":"<p>For more information, see the NIP-44 specification.</p>"},{"location":"nip44/#implementation","title":"Implementation","text":"<ul> <li>Backend: Rust implementation using <code>nostr-sdk</code> crate</li> <li>Default Version: Uses default NIP-44 version</li> <li>Key Derivation: ECDH shared secret derivation</li> <li>Message Format: Base64 encoded encrypted content</li> </ul>"},{"location":"nip44/#hybrid-encryption-for-attachments","title":"Hybrid Encryption for Attachments","text":"<p>Large file attachments use hybrid encryption: 1. Generate random AES-256 key 2. Encrypt file with AES-256 3. Encrypt AES-256 key with NIP-44 4. Send encrypted file + encrypted key</p> <p>This provides: - Efficient encryption for large files - Strong security via NIP-44 for keys - Standard encryption for file data</p>"},{"location":"quick-start/","title":"Quick Start","text":"<p>Get up and running with nostr-mail in just a few steps!</p>"},{"location":"quick-start/#initial-setup","title":"Initial Setup","text":""},{"location":"quick-start/#generate-or-import-keypair","title":"Generate or Import Keypair:","text":"<ul> <li>Navigate to Settings \u2192 Nostr Settings</li> <li>Click \"Generate New Keypair\" or paste your existing nsec/npriv key</li> <li>Important: Save your private key securely! You'll need it to decrypt messages.</li> </ul>"},{"location":"quick-start/#configure-email","title":"Configure Email:","text":"<ul> <li>Navigate to Settings \u2192 Email Settings</li> <li>Select your email provider (Gmail, Outlook, Yahoo, or Custom)</li> <li>For Gmail and Yahoo:<ul> <li>Generate an app password:<ul> <li>google: https://support.google.com/accounts/answer/185833</li> <li>yahoo: https://help.yahoo.com/kb/SLN15241.html</li> </ul> </li> <li>Enable IMAP in settings</li> </ul> </li> <li>Click \"Test Email Connection\" to verify settings</li> </ul>"},{"location":"quick-start/#configure-relays","title":"Configure Relays:","text":"<p>Nostr relays are used to communicate with the nostr network. They allow you to:     - publish your profile     - receive incoming direct messages (DMs), which are linked to specific emails in nostr-mail     - publish/retreive your public contacts     - receive/publish other nostr events</p> <p>When the app starts, you will automatically connect to a few nostr relays, but you may add to or remove them:</p> <ul> <li>Navigate to Settings \u2192 Relay Settings</li> <li>Add Nostr relays (e.g., <code>wss://relay.damus.io</code>, <code>wss://nostr-pub.wellorder.net</code>)</li> </ul>"},{"location":"quick-start/#load-contacts","title":"Load Contacts:","text":"<ul> <li>Navigate to Contacts tab</li> <li>Click \"Refresh\" to load contacts from your Nostr follow list</li> <li>Contacts with email addresses will appear at the top of your contacts list with the envelope icon (\u2709\ufe0f)</li> <li>Click on a contact to view their profile details</li> <li>If a contact has published their email address, you can click \"Send Email\" within their profile, which will you to the compose page with their information filled in.</li> </ul>"},{"location":"quick-start/#compose-your-first-email","title":"Compose Your First Email","text":"<p>1. Navigate to Compose tab</p> <p>2. Select Recipient:    - Use the dropdown to select a Nostr contact (if they have an email in their profile)    - Or manually enter an email address in the \"To:\" field</p> <p>3. Write Your Message:    - Enter a subject line    - Write your message in the text area</p> <p>4. Send:    - Click \"Send\" to send the encrypted email    - By default, the message is automatically encrypted with NIP-44 and signed with your nostr key (see Advanced settings for fine-grained control)</p>"},{"location":"quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>Read Email: Check the Inbox Page guide</li> <li>Send DMs: Learn about Direct Messages</li> <li>Manage Contacts: Explore the Contacts Page</li> <li>Configure Settings: Review the Settings Page guide</li> </ul>"},{"location":"quick-start/#tips","title":"Tips","text":"<ul> <li>Enable \"Automatically Encrypt\" and \"Automatically Sign\" in Settings for convenience</li> <li>Use multiple relays for better reliability</li> <li>Keep your private key backed up securely</li> <li>Profile pictures are cached locally for offline access</li> </ul>"},{"location":"related_work/","title":"Related Work","text":"<p>Here's other directions we've looked at for potential use in nostr-mail.</p>"},{"location":"related_work/#nip-05","title":"NIP-05","text":"<p>Note</p> <p>This is not required by nostr-mail. This section is just kept for pedagogical purposes.</p> <p>nip-05 is a Pub key validation standard based on control over a domain. Most email users will not have their own servers, however, so nostr-mail clients should not require it.</p> <p>HelloJessica is nip05 compliant, so we should be able to make a get request to his server to verify his pub key.</p> <pre><code>from nostrmail.utils import validate_nip05\n</code></pre> <pre><code>validate_nip05(node_hello_hex) # returns the name of this user according to their .com\n</code></pre> <p>Hello Jessica's NIP-05 json actually includes several other names, so this doubles as a PGP registry. However, <code>nip-02</code> provides a similar solution to registration.</p>"},{"location":"related_work/#nip-02","title":"NIP-02","text":"<p>NIP-02 Supports contacts lists, comprised of pub keys, petnames, and preferred relays. Users may be found by walking through the network of contacts. This is desirable for nostr-mail, where we want to easily look up an email address through dot notation. For instance, an email to <code>carol.bob.alice</code> means <code>find carol in my contacts</code>, then <code>find bob in carol's contacts</code>, then <code>find alice in bob's contacts</code>.</p>"},{"location":"related_work/#fernet-encryption","title":"Fernet encryption","text":"<p>Note</p> <p>Nostr-mail does not use this method. We decided to use the same scheme as NOSTr DMs to reduce the workload on other implementations.</p> <p>We could have used Fernet encryption available from the cryptography package. Fernet encryption is a form of symmetric encryption, meaning the same key may be used to encrypt and decrypt a message.</p> <pre><code>from cryptography.fernet import Fernet, InvalidToken\nimport base64\n\ndef get_fernet(key):\n    if isinstance(key, str):\n        fernet_key = base64.urlsafe_b64encode(bytes(key.ljust(32).encode()))\n    else:\n        fernet_key = base64.urlsafe_b64encode(key)\n    return Fernet(fernet_key)\n\n\ndef encrypt(message, key):\n    f = get_fernet(key)\n    token = f.encrypt(message.encode())\n\n    encrypted_msg = token.decode('ascii')\n\n    return encrypted_msg\n\ndef decrypt(message, key):\n    f = get_fernet(key)\n    decrypted_msg = f.decrypt(message.encode()).decode('ascii')\n\n    return decrypted_msg\n</code></pre> <pre><code>decrypt(encrypt('hello world', 'yowzah'), 'yowzah')\n</code></pre> <p>While apparently simpler, there are a few drawbacks that make this untenable:</p> <ul> <li>There's no <code>iv</code> token as with AES, so you have to directly match the dm with the subject when looking up emails</li> <li>All nostr-mail clients would have to implement fernet encryption in addition to AES for dms</li> </ul>"},{"location":"related_work/#totp","title":"TOTP","text":"<p>We may use a different key for each message by concatenating the shared secret with a time stamp and hashing the result. This is known as a time-based one-time password (TOTP) and should already be familiar to anyone who has used google authenticator. The time used would be the time the email was sent. The epoch needs to be large enough for the mail servers to route the message.</p> <p>It might also help to use the latest block hash as the time stamp.</p> <p>This approach may provide some additional security benefit, such as mitigating replay attacks or preventing emails from being sent from the future or something.</p> <pre><code>from cryptography.hazmat.primitives import hashes\n</code></pre> <pre><code>def sha256(message):\n    digest = hashes.Hash(hashes.SHA256())\n    digest.update(message.encode())\n    digest.update(b\"123\")\n    return digest.finalize()\n</code></pre> <pre><code>import base64\nbase64.urlsafe_b64encode(sha256('hey')).decode('ascii')\n</code></pre> <pre><code>sha256('hey')\n</code></pre> <pre><code>def hash_concat(key, value):\n    \"\"\"concatenates a message with a value and returns the hash\n    key - a binary\n    \"\"\"\n    key_str = base64.urlsafe_b64encode(key).decode('ascii')\n    return sha256(key_str + str(value))\n</code></pre> <p>Using the most recent bitcoin block</p> <pre><code>latest_block_hash = '000000000000000000065a582c53ef20e5ae37b74844b31bfcbd82f4c515fdb2'\n</code></pre> <pre><code>epoch_value = latest_block_hash\nassert sender_secret == receiver_secret\n\nprint(decrypt(encrypt(email_msg,\n                      hash_concat(sender_secret, latest_block_hash)),\n              hash_concat(receiver_secret, epoch_value)) # \n    )\n</code></pre>"},{"location":"pages/compose/","title":"Compose Page","text":"<p>The Compose page is where you create and send encrypted emails.</p>"},{"location":"pages/compose/#purpose","title":"Purpose","text":"<p>Compose and send encrypted emails to recipients, with optional Nostr direct message notifications.</p>"},{"location":"pages/compose/#key-features","title":"Key Features","text":"<ul> <li>Recipient Selection: Choose from Nostr contacts with email addresses or enter any email address manually</li> <li>Email Composition: Write subject and message body</li> <li>Encryption: Encrypt email content using NIP-44 (default) or NIP-04</li> <li>Signing: Sign emails with your Nostr private key for authentication</li> <li>Attachments: Add file attachments with automatic hybrid encryption (AES-256 for files, NIP-44 for keys)</li> <li>Draft Saving: Save drafts locally for later completion</li> <li>Preview Headers: Preview email headers before sending</li> </ul>"},{"location":"pages/compose/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/compose/#1-select-recipient","title":"1. Select Recipient","text":"<ul> <li>Use the dropdown to select a Nostr contact (if they have an email in their profile)</li> <li>Or manually enter an email address in the \"To:\" field</li> <li>When a Nostr contact is selected, their public key is displayed</li> </ul>"},{"location":"pages/compose/#2-compose-message","title":"2. Compose Message","text":"<ul> <li>Enter a subject line</li> <li>Write your message in the text area</li> </ul>"},{"location":"pages/compose/#3-add-attachments-optional","title":"3. Add Attachments (optional)","text":"<ul> <li>Click \"Add Attachments\" button</li> <li>Select one or more files</li> <li>Attachments are automatically encrypted when you encrypt the message</li> </ul>"},{"location":"pages/compose/#4-encrypt-and-sign","title":"4. Encrypt and Sign","text":"<ul> <li>Click \"Encrypt\" to encrypt the message (or enable automatic encryption in Settings)</li> <li>Click \"Sign\" to sign the message (or enable automatic signing in Settings)</li> <li>The Send button shows icons indicating what actions will be performed (\ud83d\udd12 encrypt, \u270d\ufe0f sign, \u2708\ufe0f send)</li> </ul>"},{"location":"pages/compose/#5-send-email","title":"5. Send Email","text":"<ul> <li>Click \"Send\" to send the encrypted email</li> <li>If a Nostr contact is selected and encryption is enabled, you can optionally send a matching DM notification</li> </ul>"},{"location":"pages/compose/#6-save-draft","title":"6. Save Draft","text":"<ul> <li>Click \"Save Draft\" to save your work for later</li> <li>Drafts can be resumed from the Drafts Page</li> </ul>"},{"location":"pages/compose/#configuration-options","title":"Configuration Options","text":"<ul> <li>Automatic Encryption: Enable in Settings \u2192 Advanced \u2192 Automatically Encrypt</li> <li>Automatic Signing: Enable in Settings \u2192 Advanced \u2192 Automatically Sign</li> <li>Send Matching DM: Enable in Settings \u2192 Advanced \u2192 Send Matching DM (sends DM with same subject when emailing Nostr contacts)</li> </ul>"},{"location":"pages/compose/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ul> <li>Always verify the recipient's public key when selecting a Nostr contact</li> <li>Use descriptive subject lines as they may be visible in DM notifications</li> <li>Large attachments are automatically handled with hybrid encryption</li> <li>Preview headers before sending to verify encryption and signing status</li> <li>Save drafts frequently when composing long messages</li> </ul>"},{"location":"pages/contacts/","title":"Contacts Page","text":"<p>The Contacts page displays and manages your Nostr contacts.</p>"},{"location":"pages/contacts/#purpose","title":"Purpose","text":"<p>View, search, and interact with your Nostr contacts.</p>"},{"location":"pages/contacts/#key-features","title":"Key Features","text":"<ul> <li>Contact List: View all contacts from your Nostr follow list</li> <li>Profile Details: View complete contact profiles with metadata</li> <li>Contact Actions: Send emails, DMs, or copy public keys</li> <li>Privacy Management: Change contact privacy status via profile view</li> <li>Search: Search contacts by name</li> <li>Add Contacts: Manually add contacts by public key</li> <li>Export Contacts: Export contact list as npub list</li> <li>Progressive Loading: Images load progressively for better performance</li> </ul>"},{"location":"pages/contacts/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/contacts/#1-view-contacts","title":"1. View Contacts","text":"<ul> <li>Navigate to Contacts tab</li> <li>View list of all contacts sorted alphabetically</li> <li>Click on a contact to view profile details</li> </ul>"},{"location":"pages/contacts/#2-view-profile-details","title":"2. View Profile Details","text":"<ul> <li>Click on any contact in the list</li> <li>View full profile including name, picture, about, email, and public key</li> <li>See all available profile metadata</li> </ul>"},{"location":"pages/contacts/#3-contact-actions","title":"3. Contact Actions","text":"<ul> <li>Send Email: Click \"Send Email\" to compose an email to this contact</li> <li>Send DM: Click \"Send DM\" to start a direct message conversation</li> <li>Copy Pubkey: Click \"Copy Pubkey\" to copy the contact's public key</li> </ul>"},{"location":"pages/contacts/#4-search-contacts","title":"4. Search Contacts","text":"<ul> <li>Click \"Search\" button</li> <li>Type to filter contacts by name</li> </ul>"},{"location":"pages/contacts/#5-add-contact","title":"5. Add Contact","text":"<ul> <li>Click \"Add Contact\" button</li> <li>Enter a public key (npub format) or scan QR code</li> <li>Contact will be added to your list</li> </ul>"},{"location":"pages/contacts/#6-export-contacts","title":"6. Export Contacts","text":"<ul> <li>Click \"Export Contacts\" to download a list of all npubs</li> </ul>"},{"location":"pages/contacts/#7-refresh","title":"7. Refresh","text":"<ul> <li>Click \"Refresh\" to sync contacts from published kind 3 (follow list) events on Nostr relays</li> <li>Contacts found in your published follow list are marked as public</li> <li>Contacts not in your published follow list are marked as private</li> <li>If no kind 3 event is found on any relay, sync is aborted and existing contacts are preserved (check your relay configuration)</li> <li>If a kind 3 event is found but contains 0 follows (empty list), sync is also aborted to preserve existing contacts</li> <li>Uses the latest kind 3 event from any responding relay</li> </ul>"},{"location":"pages/contacts/#public-vs-private-contacts","title":"Public vs Private Contacts","text":"<p>Contacts can be either public or private:</p> <ul> <li>Public contacts: Appear in your published kind 3 (follow list) event on relays. These are visible to others who view your public follow list.</li> <li>Private contacts: Stored locally but not published to relays. These contacts are only visible to you and won't appear in your public follow list.</li> </ul> <p>The privacy status determines whether a contact appears in your published follow list when syncing with relays.</p>"},{"location":"pages/contacts/#managing-contact-privacy","title":"Managing Contact Privacy","text":"<p>Privacy status can only be changed when viewing a contact's profile:</p> <ol> <li>Click on a contact in the contacts list to view their profile</li> <li>Use the privacy toggle in the profile view to change between public and private</li> <li>Changes are saved to the database immediately</li> <li>Privacy changes are automatically published to relays - When you toggle a contact to public or private, the updated follow list (kind 3 event) is immediately published to all active relays. If publishing fails, you'll see a warning notification and the change will remain local only</li> </ol>"},{"location":"pages/contacts/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ul> <li>Contacts are automatically loaded from your Nostr follow list</li> <li>Profile pictures are cached locally for offline access</li> <li>Only contacts with email addresses appear in the Compose page dropdown</li> <li>Use search to quickly find specific contacts</li> <li>Export contacts to backup your contact list</li> <li>Manually add contacts that aren't in your follow list</li> <li>Ensure relays are configured correctly for contact sync to work properly</li> <li>Contacts sync prioritizes published kind 3 events from relays</li> </ul>"},{"location":"pages/direct-messages/","title":"Direct Messages Page","text":"<p>The Direct Messages page manages Nostr direct message conversations.</p>"},{"location":"pages/direct-messages/#purpose","title":"Purpose","text":"<p>Send and receive encrypted direct messages via the Nostr protocol.</p>"},{"location":"pages/direct-messages/#key-features","title":"Key Features","text":"<ul> <li>Conversation List: View all DM conversations sorted by most recent</li> <li>Message Threading: View full conversation threads</li> <li>Send DMs: Send encrypted direct messages to Nostr contacts</li> <li>Real-time Updates: Receive new DMs in real-time via relay subscriptions</li> <li>Search: Search conversations by contact name</li> <li>Email Matching: See which DMs match sent emails</li> </ul>"},{"location":"pages/direct-messages/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/direct-messages/#1-view-conversations","title":"1. View Conversations","text":"<ul> <li>Navigate to Direct Messages tab</li> <li>View list of all conversations sorted by most recent message</li> <li>Click on a conversation to view messages</li> </ul>"},{"location":"pages/direct-messages/#2-send-direct-message","title":"2. Send Direct Message","text":"<ul> <li>Select a conversation or start a new one</li> <li>Type your message in the input field</li> <li>Press Enter or click Send</li> <li>Messages are automatically encrypted with NIP-44</li> </ul>"},{"location":"pages/direct-messages/#3-search-conversations","title":"3. Search Conversations","text":"<ul> <li>Click \"Search\" button</li> <li>Type to filter conversations by contact name</li> </ul>"},{"location":"pages/direct-messages/#4-refresh","title":"4. Refresh","text":"<ul> <li>Click \"Refresh\" to reload conversations from relays</li> </ul>"},{"location":"pages/direct-messages/#configuration-options","title":"Configuration Options","text":"<ul> <li>Encryption Algorithm: Choose NIP-44 (recommended) or NIP-04 in Settings \u2192 Nostr Settings \u2192 Encryption Algorithm</li> <li>Relays: Configure relays in Settings \u2192 Relay Settings</li> </ul>"},{"location":"pages/direct-messages/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ul> <li>DMs are encrypted end-to-end using NIP-44</li> <li>Conversations are automatically synced from configured relays</li> <li>DMs matching email subjects are marked for easy identification</li> <li>Use DMs for quick Nostr-native communication</li> <li>Multiple relays ensure message delivery reliability</li> <li>Real-time updates keep conversations current</li> </ul>"},{"location":"pages/drafts/","title":"Drafts Page","text":"<p>The Drafts page manages saved email drafts.</p>"},{"location":"pages/drafts/#purpose","title":"Purpose","text":"<p>View, edit, and manage saved email drafts.</p>"},{"location":"pages/drafts/#key-features","title":"Key Features","text":"<ul> <li>Draft List: View all saved drafts</li> <li>Edit Drafts: Resume editing any draft</li> <li>Delete Drafts: Remove drafts you no longer need</li> <li>Draft Details: View draft content before resuming</li> </ul>"},{"location":"pages/drafts/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/drafts/#1-view-drafts","title":"1. View Drafts","text":"<ul> <li>Navigate to Drafts tab</li> <li>View list of all saved drafts</li> </ul>"},{"location":"pages/drafts/#2-resume-draft","title":"2. Resume Draft","text":"<ul> <li>Click on a draft to view details</li> <li>Click \"Edit\" or navigate to Compose to resume editing</li> <li>Draft content is automatically loaded into the compose form</li> </ul>"},{"location":"pages/drafts/#3-delete-draft","title":"3. Delete Draft","text":"<ul> <li>Click on a draft to view details</li> <li>Click \"Delete\" to remove the draft</li> </ul>"},{"location":"pages/drafts/#4-refresh","title":"4. Refresh","text":"<ul> <li>Click \"Refresh\" to reload drafts list</li> </ul>"},{"location":"pages/drafts/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ul> <li>Drafts are saved automatically when you click \"Save Draft\" in the Compose page</li> <li>Drafts are stored locally and persist across app restarts</li> <li>Delete old drafts to keep your list organized</li> <li>Drafts include all compose form data including attachments</li> </ul>"},{"location":"pages/inbox/","title":"Inbox Page","text":"<p>The Inbox page displays all received emails, with filtering and decryption capabilities.</p>"},{"location":"pages/inbox/#purpose","title":"Purpose","text":"<p>View, search, and decrypt received emails from your IMAP server.</p>"},{"location":"pages/inbox/#key-features","title":"Key Features","text":"<ul> <li>Email List: View all emails with sender, subject, and preview</li> <li>Email Details: Full email viewing with decrypted content</li> <li>Search: Search emails by sender email address</li> <li>Filtering: Filter to show only Nostr-encrypted emails or all emails</li> <li>Decryption: Automatic decryption of encrypted emails using your private key</li> <li>Pagination: Load emails in pages (configurable page size)</li> <li>Signature Verification: Verify Nostr signatures on received emails</li> </ul>"},{"location":"pages/inbox/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/inbox/#1-view-inbox","title":"1. View Inbox","text":"<ul> <li>Navigate to Inbox tab</li> <li>Emails are automatically loaded from your IMAP server</li> <li>Click on any email to view details</li> </ul>"},{"location":"pages/inbox/#2-search-emails","title":"2. Search Emails","text":"<ul> <li>Use the search box to filter by sender email address</li> <li>Results update as you type</li> </ul>"},{"location":"pages/inbox/#3-view-email-details","title":"3. View Email Details","text":"<ul> <li>Click on an email in the list</li> <li>View full email content with decrypted body</li> <li>See encryption status and signature verification</li> </ul>"},{"location":"pages/inbox/#4-refresh-inbox","title":"4. Refresh Inbox","text":"<ul> <li>Click \"Refresh\" button to fetch new emails from server</li> </ul>"},{"location":"pages/inbox/#5-navigate-back","title":"5. Navigate Back","text":"<ul> <li>Click \"Back to Inbox\" to return to the email list</li> </ul>"},{"location":"pages/inbox/#configuration-options","title":"Configuration Options","text":"<ul> <li>Email Filter: Choose \"Nostr Emails Only\" or \"All Emails\" in Settings \u2192 Advanced \u2192 Inbox Filter</li> <li>Hide Undecryptable: Enable in Settings \u2192 Advanced \u2192 Hide Undecryptable Emails</li> <li>Require Signatures: Enable in Settings \u2192 Advanced \u2192 Require Signatures</li> <li>Hide Unverified: Enable in Settings \u2192 Advanced \u2192 Hide Unverified</li> <li>Emails Per Page: Configure in Settings \u2192 Advanced \u2192 Emails Per Page (default: 50)</li> </ul>"},{"location":"pages/inbox/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ul> <li>Use \"Nostr Emails Only\" filter to focus on encrypted communications</li> <li>Enable signature verification to ensure email authenticity</li> <li>Undecryptable emails are hidden by default (can be shown by disabling the setting)</li> <li>Refresh regularly to stay up-to-date with new emails</li> <li>Use search to quickly find emails from specific senders</li> </ul>"},{"location":"pages/profile/","title":"Profile Page","text":"<p>The Profile page manages your Nostr profile.</p>"},{"location":"pages/profile/#purpose","title":"Purpose","text":"<p>Create and update your Nostr profile metadata.</p>"},{"location":"pages/profile/#key-features","title":"Key Features","text":"<ul> <li>Profile Fields: Edit name, display name, picture, about, email, and custom fields</li> <li>Profile Picture: Upload and set profile picture</li> <li>Publish Profile: Publish profile updates to Nostr relays</li> <li>Profile Preview: See your profile as others see it</li> </ul>"},{"location":"pages/profile/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/profile/#1-view-profile","title":"1. View Profile","text":"<ul> <li>Navigate to Profile tab</li> <li>View your current profile fields</li> </ul>"},{"location":"pages/profile/#2-edit-profile","title":"2. Edit Profile","text":"<ul> <li>Click on any field to edit</li> <li>Update name, display name, about, email, etc.</li> <li>Add custom profile fields</li> </ul>"},{"location":"pages/profile/#3-set-profile-picture","title":"3. Set Profile Picture","text":"<ul> <li>Click on profile picture area</li> <li>Select an image file</li> <li>Picture is automatically uploaded and cached</li> </ul>"},{"location":"pages/profile/#4-update-profile","title":"4. Update Profile","text":"<ul> <li>Click \"Update Profile\" button</li> <li>Profile is published to configured Nostr relays</li> <li>Changes are visible to others immediately</li> </ul>"},{"location":"pages/profile/#5-refresh","title":"5. Refresh","text":"<ul> <li>Click \"Refresh\" to reload profile from relays</li> </ul>"},{"location":"pages/profile/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ul> <li>Profile updates are published as Nostr kind 0 events</li> <li>Include your email address so others can send you encrypted emails</li> <li>Profile pictures are cached and displayed in contacts</li> <li>Custom fields allow you to add any additional metadata</li> <li>Keep your profile up-to-date for better contact discovery</li> <li>Profile changes are permanent on Nostr relays</li> </ul>"},{"location":"pages/sent/","title":"Sent Page","text":"<p>The Sent page displays all emails you've sent.</p>"},{"location":"pages/sent/#purpose","title":"Purpose","text":"<p>View and manage sent email history.</p>"},{"location":"pages/sent/#key-features","title":"Key Features","text":"<ul> <li>Sent Email List: View all sent emails with recipient, subject, and timestamp</li> <li>Email Details: View full sent email content</li> <li>Search: Search sent emails by recipient or subject</li> <li>Pagination: Load sent emails in pages</li> </ul>"},{"location":"pages/sent/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/sent/#1-view-sent-emails","title":"1. View Sent Emails","text":"<ul> <li>Navigate to Sent tab</li> <li>View list of all sent emails</li> <li>Click on any email to view details</li> </ul>"},{"location":"pages/sent/#2-search-sent-emails","title":"2. Search Sent Emails","text":"<ul> <li>Use the search box to filter sent emails</li> <li>Search by recipient or subject</li> </ul>"},{"location":"pages/sent/#3-view-email-details","title":"3. View Email Details","text":"<ul> <li>Click on an email to view full content</li> <li>See encryption and signing status</li> </ul>"},{"location":"pages/sent/#4-refresh","title":"4. Refresh","text":"<ul> <li>Click \"Refresh\" to reload sent emails</li> </ul>"},{"location":"pages/sent/#tips-and-best-practices","title":"Tips and Best Practices","text":"<ul> <li>Sent emails are stored locally in the database</li> <li>Use search to quickly find specific sent emails</li> <li>Sent emails show encryption and signing status</li> <li>Review sent emails to verify they were properly encrypted and signed</li> </ul>"},{"location":"pages/settings/","title":"Settings Page","text":"<p>The Settings page configures all application settings.</p>"},{"location":"pages/settings/#purpose","title":"Purpose","text":"<p>Configure email, Nostr, relays, and application preferences.</p>"},{"location":"pages/settings/#key-features","title":"Key Features","text":"<ul> <li>Nostr Settings: Keypair management, encryption algorithm selection</li> <li>Email Settings: SMTP and IMAP configuration</li> <li>Relay Settings: Add, remove, and manage Nostr relays</li> <li>Advanced Settings: Email preferences, filtering, sync options</li> <li>Appearance: Dark mode toggle</li> </ul>"},{"location":"pages/settings/#usage-instructions","title":"Usage Instructions","text":""},{"location":"pages/settings/#nostr-settings","title":"Nostr Settings","text":""},{"location":"pages/settings/#private-key-management","title":"Private Key Management","text":"<ul> <li>Enter your nsec/npriv key or generate a new one</li> <li>Toggle visibility, copy, or show QR code</li> <li>Public key (npub) is automatically derived</li> </ul>"},{"location":"pages/settings/#encryption-algorithm","title":"Encryption Algorithm","text":"<ul> <li>Select \"NIP-44 (Recommended)\" or \"NIP-04 (Legacy)\"</li> <li>NIP-44 is the modern, secure standard</li> </ul>"},{"location":"pages/settings/#generate-keypair","title":"Generate Keypair","text":"<ul> <li>Click \"Generate New Keypair\" to create a new keypair</li> <li>Important: Save your private key securely!</li> </ul>"},{"location":"pages/settings/#email-settings","title":"Email Settings","text":""},{"location":"pages/settings/#email-provider","title":"Email Provider","text":"<ul> <li>Select your provider (Gmail, Outlook, Yahoo, or Custom)</li> <li>Provider-specific settings are auto-filled</li> </ul>"},{"location":"pages/settings/#email-configuration","title":"Email Configuration","text":"<ul> <li>Enter email address and password/app password</li> <li>Configure SMTP host and port (default: 587)</li> <li>Configure IMAP host and port (default: 993)</li> <li>Enable TLS/SSL (recommended)</li> </ul>"},{"location":"pages/settings/#test-connection","title":"Test Connection","text":"<ul> <li>Click \"Test Email Connection\" to verify settings</li> </ul>"},{"location":"pages/settings/#relay-settings","title":"Relay Settings","text":""},{"location":"pages/settings/#add-relay","title":"Add Relay","text":"<ul> <li>Enter relay URL (e.g., <code>wss://relay.damus.io</code>)</li> <li>Click \"Add\" to add relay</li> <li>Relays are used for DMs and profile updates</li> </ul>"},{"location":"pages/settings/#manage-relays","title":"Manage Relays","text":"<ul> <li>Enable/disable relays by toggling switches</li> <li>Remove relays you no longer need</li> </ul>"},{"location":"pages/settings/#advanced-settings","title":"Advanced Settings","text":""},{"location":"pages/settings/#inbox-filter","title":"Inbox Filter","text":"<ul> <li>Choose \"Nostr Emails Only\" or \"All Emails\"</li> </ul>"},{"location":"pages/settings/#email-preferences","title":"Email Preferences","text":"<ul> <li>Send Matching DM: Automatically send DM when emailing Nostr contacts</li> <li>Require Signatures: Only accept emails with valid signatures</li> <li>Hide Undecryptable Emails: Hide emails that can't be decrypted</li> <li>Automatically Encrypt: Encrypt all outgoing emails</li> <li>Automatically Sign: Sign all outgoing emails</li> <li>Hide Unverified: Hide messages without verified signatures</li> </ul>"},{"location":"pages/settings/#sync-settings","title":"Sync Settings","text":"<ul> <li>Sync Cutoff: How far back to sync emails (default: 365 days)</li> <li>Emails Per Page: Number of emails per page (default: 50)</li> </ul>"},{"location":"pages/settings/#appearance","title":"Appearance","text":""},{"location":"pages/settings/#dark-mode","title":"Dark Mode","text":"<ul> <li>Toggle dark mode on/off</li> <li>Preference is saved and persists across sessions</li> </ul>"},{"location":"pages/settings/#configuration-tips","title":"Configuration Tips","text":""},{"location":"pages/settings/#gmail-setup","title":"Gmail Setup","text":"<ol> <li>Generate an app password: https://support.google.com/accounts/answer/185833</li> <li>Remove spaces from the app password</li> <li>Enable IMAP in Gmail settings</li> <li>Use SMTP: <code>smtp.gmail.com:587</code>, IMAP: <code>imap.gmail.com:993</code></li> </ol>"},{"location":"pages/settings/#security","title":"Security","text":"<ul> <li>Never share your private key (nsec/npriv)</li> <li>Use app passwords instead of your main email password</li> <li>Enable TLS/SSL for all email connections</li> <li>Use NIP-44 encryption (not NIP-04)</li> </ul>"},{"location":"pages/settings/#relays","title":"Relays","text":"<ul> <li>Add multiple relays for redundancy</li> <li>Use reliable, well-maintained relays</li> <li>Test relay connections regularly</li> </ul>"}]}